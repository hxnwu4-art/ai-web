<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>AI</title>

  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;800&display=swap" rel="stylesheet">

  <style>
    *{
      margin:0;
      padding:0;
      box-sizing:border-box;
      font-family:'Nunito',sans-serif;
    }

    body{
      height:100dvh;
      background:linear-gradient(160deg,#f3e8ff,#dff7ff);
      display:flex;
      flex-direction:column;
      align-items:center;
      overflow:hidden;
      position:relative;
    }

    header{
      width:100%;
      padding:40px 20px 4px;
      text-align:center;
      font-size:24px;
      font-weight:800;
      color:#444;
    }

    .description{
      font-size:13px;
      color:#666;
      margin-bottom:8px;
      text-align:center;
    }

    .voice-section{
      flex:1;
      display:flex;
      align-items:center;
      justify-content:center;
      padding-bottom:120px; /* ë°‘ì— ë©”ë‰´, ì±„íŒ… ì…ë ¥ ê³µê°„ í™•ë³´ */
      width:100%;
    }

    .voice-button{
      width:200px;
      height:200px;
      border-radius:50%;
      background:linear-gradient(145deg,#ffd6f9,#c6e8ff);
      box-shadow:
        20px 20px 40px rgba(0,0,0,0.15),
        -20px -20px 40px rgba(255,255,255,0.8);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:60px;
      cursor:pointer;
      transition:.2s;
    }

    .voice-button:active{
      transform:scale(0.95);
      box-shadow:
        inset 15px 15px 30px rgba(0,0,0,0.15),
        inset -15px -15px 30px rgba(255,255,255,0.8);
    }

    /* ì±„íŒ… ë°•ìŠ¤ */
    .chat-container{
      position:fixed;
      bottom:140px;
      left:50%;
      transform:translateX(-50%);
      width:90%;
      max-width:420px;
      background:rgba(255,255,255,0.6);
      backdrop-filter:blur(14px);
      border-radius:24px;
      padding:10px;
      box-shadow:
        6px 6px 15px rgba(0,0,0,0.1),
        -6px -6px 15px rgba(255,255,255,0.8);
    }

    #chatBox{
      max-height:180px;
      overflow-y:auto;
      font-size:13px;
      margin-bottom:8px;
    }

    .chat-row{
      margin-bottom:4px;
    }
    .chat-user{
      font-weight:700;
    }
    .chat-ai{
      font-weight:700;
    }

    .chat-input-row{
      display:flex;
      gap:6px;
    }

    .chat-input-row input{
      flex:1;
      padding:8px 10px;
      border-radius:20px;
      border:none;
      outline:none;
      font-size:13px;
    }

    .chat-input-row button{
      padding:8px 12px;
      border-radius:20px;
      border:none;
      background:#c6e8ff;
      font-size:13px;
      cursor:pointer;
    }

    /* í•˜ë‹¨ ë©”ë‰´ */
    .bottom-menu{
      position:fixed;
      bottom:0;
      left:0;
      width:100%;
      padding:16px 10px 26px;
      display:flex;
      justify-content:space-around;
      background:rgba(255,255,255,0.35);
      backdrop-filter:blur(15px);
      border-top-left-radius:40px;
      border-top-right-radius:40px;
    }

    .menu-button{
      width:90px;
      height:90px;
      border-radius:28px;
      background:linear-gradient(145deg,#ffffff,#e8e8e8);
      box-shadow:
        10px 10px 20px rgba(0,0,0,0.1),
        -10px -10px 20px rgba(255,255,255,0.8);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      font-size:22px;
      transition:.2s;
    }

    .menu-button span{
      font-size:13px;
      margin-top:6px;
    }

    .menu-button:active{
      transform:scale(0.95);
      box-shadow:
        inset 6px 6px 12px rgba(0,0,0,0.15),
        inset -6px -6px 12px rgba(255,255,255,0.8);
    }
  </style>
</head>

<body>

  <header>AI</header>
  <div class="description">ì¡´ëŒ“ë§ Â· ë‹¤ì •í•¨ Â· ìì„¸í•œ ì„¤ëª… Â· í™”ë‚´ì§€ ì•ŠìŒ</div>

  <div class="voice-section">
    <div class="voice-button" id="voiceBtn">ğŸ¤</div>
  </div>

  <!-- ì±„íŒ… ì˜ì—­ -->
  <div class="chat-container">
    <div id="chatBox"></div>
    <div class="chat-input-row">
      <input id="userInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
      <button id="sendBtn">ë³´ë‚´ê¸°</button>
    </div>
  </div>

  <!-- í•˜ë‹¨ ë©”ë‰´ -->
  <div class="bottom-menu">
    <div class="menu-button" id="menuChat">
      ğŸ’¬
      <span>ì±„íŒ…</span>
    </div>

    <div class="menu-button" id="menuImage">
      ğŸ¨
      <span>ì´ë¯¸ì§€</span>
    </div>

    <div class="menu-button" id="menuHistory">
      ğŸ§ 
      <span>ê¸°ë¡</span>
    </div>
  </div>

  <script>
    // ë‚˜ì¤‘ì— ìŒì„± ê¸°ëŠ¥ ë¶™ì¼ ë•Œ ì—¬ê¸°ì„œ ì²˜ë¦¬
    document.getElementById("voiceBtn").addEventListener("click", () => {
      alert("ìŒì„±ì±„íŒ…ì€ ë‚˜ì¤‘ì— OpenAI ìŒì„± API ì—°ê²°í•  ë•Œ ë¶™ì¼ ê±°ì„ ğŸ¤");
    });

    // ì±„íŒ… ë³´ë‚´ê¸°
    async function sendMessage() {
      const input = document.getElementById("userInput");
      const chatBox = document.getElementById("chatBox");
      const text = input.value.trim();
      if (!text) return;

      // ìœ ì € ë©”ì‹œì§€ í‘œì‹œ
      const userRow = document.createElement("div");
      userRow.className = "chat-row";
      userRow.innerHTML = `<span class="chat-user">ğŸ‘¤ you:</span> ${text}`;
      chatBox.appendChild(userRow);

      input.value = "";
      chatBox.scrollTop = chatBox.scrollHeight;

      try {
        const res = await fetch("/api/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });

        const data = await res.json();

        const aiRow = document.createElement("div");
        aiRow.className = "chat-row";
        aiRow.innerHTML = `<span class="chat-ai">ğŸ¤– AI:</span> ${data.reply || "(ì‘ë‹µ ì—†ìŒ)"}`;
        chatBox.appendChild(aiRow);
        chatBox.scrollTop = chatBox.scrollHeight;
      } catch (e) {
        const errRow = document.createElement("div");
        errRow.className = "chat-row";
        errRow.innerHTML = `<span class="chat-ai">âš ï¸:</span> ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”`;
        chatBox.appendChild(errRow);
      }
    }

    document.getElementById("sendBtn").addEventListener("click", sendMessage);
    document.getElementById("userInput").addEventListener("keydown", (e) => {
      if (e.key === "Enter") sendMessage();
    });

    // ë©”ë‰´ ë²„íŠ¼ë“¤(ë‚˜ì¤‘ì— í˜ì´ì§€ ë¶„ë¦¬í•˜ë©´ ì—¬ê¸°ì„œ ë¼ìš°íŒ…)
    document.getElementById("menuChat").addEventListener("click", () => {
      alert("ì§€ê¸ˆ í™”ë©´ì´ ì±„íŒ… í™”ë©´ì´ì—ìš” ğŸ’¬");
    });

    document.getElementById("menuImage").addEventListener("click", () => {
      alert("2ë‹¨ê³„ì—ì„œ ì´ë¯¸ì§€ ìƒì„± UIë‘ /api/image ì—°ê²°í•´ì¤„ ê±°ì„ ğŸ¨");
    });

    document.getElementById("menuHistory").addEventListener("click", () => {
      alert("ë‚˜ì¤‘ì— ëŒ€í™” ê¸°ë¡ ê¸°ëŠ¥ ë¶™ì¼ ìˆ˜ ìˆìŒ ğŸ§ ");
    });
  </script>

</body>
</html>
